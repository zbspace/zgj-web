import{_ as e}from"./gengduo-caozuo-730fe1cb.js";import{J as a}from"./JyTable-735e5f88.js";import{a7 as t,_ as o,v as l,h as n,i as d,s as r,r as m,o as s,c as p,a as c,w as i,u,m as h,f as y,ai as g,l as f,F as C,M as b,j as w,t as x,g as A,Y as j,y as v,z as D}from"./main-e75bd94c.js";import{_ as F}from"./ketanchude-a94e84bc.js";import{_ as I}from"./index-7d24f6f8.js";import"./sangedian-6ea00dcf.js";import"./Layout-a5f6ee71.js";import"./searchForm-6ca4b4e4.js";import"./KDocumentTypeDialog-6b47a1ba.js";import"./pagination-10abb664.js";import"./batch-99f4afc3.js";import"./index-7c7937e4.js";import"./index-0048e34a.js";import"./cha-kong-c10eac4e.js";import"./index-1f964f06.js";import"./yuan-hui-31c99901.js";import"./index-4846a83d.js";import"./home-back-d5b479fa.js";import"./logo-ad08cc7e.js";import"./request-util-a1644b44.js";const B={getRelatedCompanyList:e=>t({method:"GET",url:"/tenant/relatedCompany/list",params:e}),addRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/add",data:e}),updateRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/update",data:e}),deleteRelatedCompany:e=>t({method:"POST",url:"/tenant/relatedCompany/delete",data:e}),batchImportRelatedCompany:e=>t({method:"GET",url:"/tenant/relatedCompany/batchImport",params:e}),detailRelatedCompany:e=>t({method:"GET",url:`/tenant/relatedCompany/detail/${e}`}),detailGetRelatedCompanyNo:e=>t({method:"GET",url:"/tenant/relatedCompany/getRelatedCompanyNo"})},N={class:"select-box-contBox"},V={class:"ap-box-contBox-icon"},E=o({props:{showAdd:{type:Boolean,default:!1},title:{type:String,default:"t-zgj-add"},column:{type:Object,default:()=>({})}},emits:["update:showAdd","on-confirm","on-cancel"],setup(e,{emit:a}){const t=e,o=l(null),w=l(!1),x=n({searchSelected:[],componentsAddForm:{formData:{relatedCompanyName:"",organId:"",organName:"",contactName:"",contactInformation:"",relatedCompanyId:"",readme:""},formRules:{relatedCompanyName:[{required:!0,message:"请输入企业名称",trigger:"change"}],organId:[{required:!0,message:"请选择所属部门",trigger:"change"}],contactName:[{required:!0,message:"请输入联系人",trigger:"change"}],contactInformation:[{required:!0,message:"请输入正确的手机号",pattern:/^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/,trigger:"change"}]}}});d((()=>t.column),(e=>{if(e)if("t-zgj-Edit"===t.title){x.searchSelected=[{id:e.organId,idFullPathSet:[e.organId],name:e.organName,type:"organ"}];for(const a in e)x.componentsAddForm.formData[a]=e[a]}else{if(o.value){o.value.resetFields(),x.searchSelected=[];for(const e in x.componentsAddForm.formData)x.componentsAddForm.formData[e]=""}A()}}));const A=()=>{B.detailGetRelatedCompanyNo().then((e=>{200===e.code&&(x.componentsAddForm.formData.relatedCompanyNo=e.data)}))},j=r({get:()=>t.showAdd,set(e){a("update:showAdd",e)}}),v=()=>{a("on-cancel",!1)},D=()=>{o.value.validate((e=>{e&&(x.componentsAddForm.formData.relatedCompanyId&&"t-zgj-Edit"===t.title?B.updateRelatedCompany(x.componentsAddForm.formData).then((e=>{a("on-confirm",e,"修改")})):B.addRelatedCompany(x.componentsAddForm.formData).then((e=>{a("on-confirm",e,"新增")})))}))},I=e=>{w.value=!0},E=e=>{e&&e.length>0&&(x.searchSelected=e,x.componentsAddForm.formData.organName=e[0].name,x.componentsAddForm.formData.organId=e[0].id),w.value=!1};return(e,a)=>{const l=m("el-input"),n=m("el-form-item"),d=m("el-form"),r=b;return s(),p(C,null,[c(r,{"onUpdate:show":a[10]||(a[10]=e=>j.value=e),show:u(j),title:e.$t(t.title),centerBtn:!0,confirmText:e.$t("t-zgj-operation.submit"),concelText:e.$t("t-zgj-operation.cancel"),width:900,height:420,onClose:v,onConfirm:D},{default:i((()=>[c(d,{model:u(x).componentsAddForm.formData,rules:u(x).componentsAddForm.formRules,ref_key:"formRef",ref:o,"label-width":"100px"},{default:i((()=>[c(n,{label:"企业编码",prop:"relatedCompanyNo"},{default:i((()=>[c(l,{type:"hidden",modelValue:u(x).componentsAddForm.formData.relatedCompanyId,"onUpdate:modelValue":a[0]||(a[0]=e=>u(x).componentsAddForm.formData.relatedCompanyId=e)},null,8,["modelValue"]),c(l,{disabled:"",modelValue:u(x).componentsAddForm.formData.relatedCompanyNo,"onUpdate:modelValue":a[1]||(a[1]=e=>u(x).componentsAddForm.formData.relatedCompanyNo=e),placeholder:"请输入企业编码"},null,8,["modelValue"])])),_:1}),c(n,{label:"企业名称",prop:"relatedCompanyName"},{default:i((()=>[c(l,{modelValue:u(x).componentsAddForm.formData.relatedCompanyName,"onUpdate:modelValue":a[2]||(a[2]=e=>u(x).componentsAddForm.formData.relatedCompanyName=e),placeholder:"请输入企业名称",clearable:"",maxlength:"128"},null,8,["modelValue"])])),_:1}),c(n,{label:"所属部门",prop:"organId"},{default:i((()=>[h("div",N,[c(l,{class:"ap-box-contBox-input width-100",readonly:"",modelValue:u(x).componentsAddForm.formData.organName,"onUpdate:modelValue":a[3]||(a[3]=e=>u(x).componentsAddForm.formData.organName=e),placeholder:"请选择",onClick:a[4]||(a[4]=e=>I())},null,8,["modelValue"]),c(l,{type:"hidden",modelValue:u(x).componentsAddForm.formData.organId,"onUpdate:modelValue":a[5]||(a[5]=e=>u(x).componentsAddForm.formData.organId=e)},null,8,["modelValue"]),h("div",V,[h("img",{onClick:a[6]||(a[6]=e=>I()),class:"ap-box-contBox-icon-img",src:F,alt:""})])])])),_:1}),c(n,{label:"联系人",prop:"contactName"},{default:i((()=>[c(l,{modelValue:u(x).componentsAddForm.formData.contactName,"onUpdate:modelValue":a[7]||(a[7]=e=>u(x).componentsAddForm.formData.contactName=e),placeholder:"请输入联系人",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),c(n,{label:"联系方式",prop:"contactInformation"},{default:i((()=>[c(l,{modelValue:u(x).componentsAddForm.formData.contactInformation,"onUpdate:modelValue":a[8]||(a[8]=e=>u(x).componentsAddForm.formData.contactInformation=e),placeholder:"请输入联系方式",clearable:"",maxlength:"64"},null,8,["modelValue"])])),_:1}),c(n,{label:"备注",prop:"readme"},{default:i((()=>[c(l,{type:"textarea",rows:4,modelValue:u(x).componentsAddForm.formData.readme,"onUpdate:modelValue":a[9]||(a[9]=e=>u(x).componentsAddForm.formData.readme=e),placehoder:"请输入备注",maxlength:"512"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["show","title","confirmText","concelText"]),w.value?(s(),y(g,{key:0,show:w.value,"onUpdate:show":a[11]||(a[11]=e=>w.value=e),tabsShow:["organ"],multiple:!1,"onUpdate:searchSelected":E,searchSelected:u(x).searchSelected},null,8,["show","searchSelected"])):f("",!0)],64)}}},[["__scopeId","data-v-7c71dbe5"]]),_={class:"title"},z={class:"title-more"},S={class:"title-more-add"},J={class:"title-more-down"},M=(e=>(v("data-v-49cd03c2"),e=e(),D(),e))((()=>h("img",{class:"button-icon",src:e,alt:"",srcset:""},null,-1))),k={class:"header-div"},R=["src"],T=o({setup(e){const t=l(!1),o=l([]),d=l(!1),r=l(null),y=n({title:"新增",column:{},relatedCompanyIds:[],componetsAddForm:{showAddDialog:!1},componentsSearchForm:{style:{lineStyle:{width:"30%"},labelStyle:{width:"100px"}},data:[{id:"relatedCompanyName",label:"关键词",type:"input",inCommonUse:!0,defaultAttribute:{placeholder:"企业名称/企业编码/联系人/联系方式"}},{id:"organId",requestParams:"organId",label:"所属部门",type:"derivable",inCommonUse:!0,defaultAttribute:{type:"organ",placeholder:"+所属部门",joinStr:",",multiple:!0},values:[]}],butData:[{id:"more",name:"展开",type:"unfold",defaultAttribute:{type:"primary"},style:{}},{id:"inquire",name:"t-zgj-query",type:"click",defaultAttribute:{type:"primary"},style:{}},{id:"reset",name:"t-zgj-reset",type:"click",defaultAttribute:{},style:{}}]},componentsTable:{header:[{prop:"relatedCompanyName",label:"企业名称",sortable:!0,"min-width":150,fixed:!0,"show-overflow-tooltip":!0,show:!0},{prop:"relatedCompanyNo",label:"企业编码",sortable:!0,show:!0,"min-width":150},{prop:"organName",label:"所属部门",sortable:!0,show:!0,"min-width":150},{prop:"contactName",label:"联系人",sortable:!0,show:!0,"min-width":150},{prop:"contactInformation",label:"联系方式",sortable:!0,show:!0,"min-width":150},{prop:"readme",label:"备注",sortable:!0,show:!0,"min-width":150,"show-overflow-tooltip":!0},{prop:"7",label:"操作",fixed:"right",width:"120px",show:!0,align:"center",rankDisplayData:[{name:"t-zgj-Edit"},{name:"t-zgj-Delete"}]}],data:[],defaultAttribute:{stripe:!0,"header-cell-style":{background:"var(--jy-color-fill--3)"},"cell-style":({row:e,column:a,rowIndex:t,columnIndex:o})=>{if("relatedCompanyName"===a.property)return{color:"var(--jy-info-6)",cursor:"pointer"}}},loading:!1},componentsPagination:{data:{amount:0,index:1,pageNumber:10},defaultAttribute:{layout:"prev, pager, next, jumper",total:0,"page-sizes":[10,50,100],background:!0}},componentsBatch:{selectionData:[],defaultAttribute:{disabled:!0},data:[{name:"t-zgj-seal.BatchDelete"}]},JyElMessageBox:{show:!1,header:{data:"",icon:"/src/assets/svg/common/warning.svg"},content:{data:""},type:"删除"}}),g=()=>{d.value=!1},f=(e,a)=>{200===e.code&&(j.success(`${a}成功！`),d.value=!1,r.value.reloadData())};function C(e,a,l,n){"relatedCompanyName"===a.property&&(t.value=!0,o.value=[{value:"detail",params:e.relatedCompanyId}])}function b(e,a,t,o){y.relatedCompanyIds=[],y.relatedCompanyIds.push(a.relatedCompanyId),"t-zgj-Edit"===t.name&&(y.title="t-zgj-Edit",B.detailRelatedCompany(a.relatedCompanyId).then((e=>{200===e.code&&(y.column=e.data,d.value=!0)}))),"t-zgj-Delete"===t.name&&(y.JyElMessageBox.header.data="t-zgj-Delete",y.JyElMessageBox.content.data="请问确定要删除吗？",y.JyElMessageBox.show=!0)}const v=e=>{B.deleteRelatedCompany({relatedCompanyIds:y.relatedCompanyIds}).then((a=>{200===a.code&&(j.success(`${e}成功！`),y.JyElMessageBox.show=!1,r.value.reloadData())}))},D=(e,a)=>{y.relatedCompanyIds=[];const t=y.componentsBatch.selectionData=a;let o="";const l=[],n=[];t.forEach((e=>{l.push(`[${e.relatedCompanyName}]`),n.push(e.relatedCompanyId)})),y.relatedCompanyIds=n,o=l.join("、"),"t-zgj-seal.BatchDelete"===e.name&&(y.JyElMessageBox.header.data="t-zgj-seal.BatchDelete",y.JyElMessageBox.content.data=`已选中往来企业：${o}，请问确定要批量删除吗？`,y.JyElMessageBox.show=!0,y.JyElMessageBox.type="批量删除")};return w((()=>{})),(e,l)=>{const n=m("el-button"),w=m("el-dropdown-item"),j=m("el-dropdown-menu"),F=m("el-dropdown"),B=m("JyElMessageBox");return s(),p("div",null,[c(a,{url:"/tenant/relatedCompany/list",ref_key:"table",ref:r,needAutoRequest:!0,componentsSearchForm:u(y).componentsSearchForm,componentsTableHeader:u(y).componentsTable.header,componentsBatch:u(y).componentsBatch,tableClick:"relatedCompanyName",onCellClick:C,onCustomClick:b,onClickBatchButton:D},{title:i((()=>[h("div",_,[h("div",null,x(e.$t("t-zgj-F_CUSTOMER_MANAGE")),1),h("div",z,[h("div",S,[c(n,{type:"primary",onClick:l[0]||(l[0]=()=>{d.value=!0,u(y).title="t-zgj-add",u(y).column={}})},{default:i((()=>[A(" + "+x(e.$t("t-zgj-add")),1)])),_:1})]),h("div",J,[c(F,null,{dropdown:i((()=>[c(j,null,{default:i((()=>[c(w,null,{default:i((()=>[A(x(e.$t("t-zgj-importCustomer.title")),1)])),_:1})])),_:1})])),default:i((()=>[c(n,null,{default:i((()=>[M,h("span",null,x(e.$t("t-zgj-table.more.Operation")),1)])),_:1})])),_:1})])])])])),_:1},8,["componentsSearchForm","componentsTableHeader","componentsBatch"]),c(I,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value=e),modulesName:"dealing_unit",detailParams:o.value,importParams:e.importParams},null,8,["modelValue","detailParams","importParams"]),c(E,{showAdd:d.value,title:u(y).title,column:u(y).column,onOnCancel:g,onOnConfirm:f},null,8,["showAdd","title","column"]),c(B,{modelValue:u(y).JyElMessageBox.show,"onUpdate:modelValue":l[2]||(l[2]=e=>u(y).JyElMessageBox.show=e),show:u(y).JyElMessageBox.show,defaultAttribute:{},showClose:!1,onConfirmClick:l[3]||(l[3]=a=>{return t=e.$t(u(y).JyElMessageBox.header.data),void v(t);var t})},{header:i((()=>[h("div",k,[h("img",{src:u(y).JyElMessageBox.header.icon,alt:""},null,8,R),h("span",null,x(e.$t(u(y).JyElMessageBox.header.data)),1)])])),content:i((()=>[A(x(u(y).JyElMessageBox.content.data),1)])),_:1},8,["modelValue","show"])])}}},[["__scopeId","data-v-49cd03c2"]]);export{T as default};
